---
title: Get help with Connected AWS Gateway
linkTitle: Get help with Connected AWS Gateway
draft: false
weight: 55
---
Troubleshooting and error codes that you may encounter while working with the connected managed environment for AWS API Gateway within Amplify.

## Troubleshooting

This section describe the common error cases you can encounter when using agents for the first time. If your error is not listed, please check the [Understand the agent log](/docs/connect_manage_environ/connect_aws_gateway/tips-and-troubleshooting/#understand-the-agent-logs) and [Error Codes and Mitigations](/docs/connect_manage_environ/connect_aws_gateway/tips-and-troubleshooting/#error-codes-and-mitigations) sections.

| Question                                                                            | Answer                                                                                                                                                                                                                                                                                                                                                                        |
| ----------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Why isn't my API discovered?                                                        | Check that the tag set on the stage has a correct name and value based on the `AWS_FILTER` variable.                                                                                                                                                                                                                                                                          |
| Why can't my agents connect to AWS API Gateway?                                     | Check that agent environment variables `AWS_REGION` is valid. Also check that the EC2 instance / ECS fargate instance is up and running.                                                                                                                                                                                                                 |
| Why can't my agents connect to Amplify?                                             | Go to Amplify > Organization > Service Accounts and make sure that the Service Account is correctly named and valid in `CENTRAL_AUTH_CLIENTID` variable. Also make sure that the organizationID (`CENTRAL_ORGANIZATIONID`) is correct.                                                                                                                                        |
| Why don't I see traffic in Amplify Business Insights?                               | Make sure that the `TRACEABILITY_HOST` and `TRACEABILITY_PORT` are accessible from the machine where Traceability Agent is installed. If you are using a proxy (`TRACEABILITY_PROXYURL`), make sure the connections are opened correctly. Refer to [Communication ports](/docs/connect_manage_environ/connected_agent_common_reference/network_traffic/#communication-ports). |
| Why isn't my agent status displayed in the environment details page?                | It is possible that your agents and their corresponding resources are not linked together. Follow [this procedure](/docs/connect_manage_environ//environment_agent_resources) to ensure the correct usage of agent resources.                                                                                                                                                 |
| Why is my Traceability Agent receiving EOF errors while sending transaction events? | It is possible that the number of `TRACEABILITY_WORKER` is set too high. Lower the number of configured workers.                                                                                                                                                                                                                                                              |

## Understand the agent logs

Each log is displayed in a JSON format following this pattern: {"level":"info|debug|trace|warn","msg":"messageFromTheAgentGoesHere","time":"messageTimestamp"}

The agent logging mechanism is based on logrus (<https://github.com/sirupsen/logrus>) and can display several levels of information:

* **info** (default): informative log about the agent activity (start, stop, discovering API, publishing traffic, etc.).
* **debug**: same as info level plus some troubleshooting information (healthcheck, connection to Amplify / Gateway, etc.).
* **trace**: same as debug plus all information related to API call (action / duration / return code / endpoint).

The log level definition is provided using the `LOG_LEVEL` variable set in the agent configuration file.

All agents logs are redirected to CloudWatch. For accessing the logs, log into Amazon console and navigate to CloudWatch service > Logs > Log groups. You will see the two agent logs there: `amplify-discovery-agent.log` and `amplify-traceability-agent.log`. Each log stream will contain the agent logs.

{{< alert title="Note" color="primary" >}}If you change any configuration, you must re-upload your agent environment variable files into the s3 bucket used during installation and restart your EC2 / ECS Fargate instance to use the new configuration setting.{{< /alert >}}

## Error Codes and Mitigations

In case an error is encountered, the agent will automatically log it based on the logging definition.

The error message format is: `Component - [Error Code _ErrorCode_] error message`.

Below is the list of error codes and possible remediations.

| Code # | Description                                                                                                                                          | Mitigation                                                                                                                                                                                                                                                                                       |
| ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
|        | **Amplify Agent SDK errors**                                                                                                                         |                                                                                                                                                                                                                                                                                                  |
| 1001   | initialization error checking for dependencies to respond, possibly network or settings                                                              | Typically, a previous error in the log is displayed. See [Administer AWS Gateway network traffic](/docs/connect_manage_environ/connected_agent_common_reference/network_traffic/) and [Reference - Agent configuration](/docs/connect_manage_environ/connect_aws_gateway/deploy-your-agents-1/). |
| 1004   | error starting status update job                                                                                                                     | Internal system error. Contact your system administrator.                                                                                                                                                                                                                                        |
| 1005   | error starting agent version checker                                                                                                                 | Build version is missing or of noncompliant semantic versioning. Check the build version of your agent.                                                                                                                                                                                          |
| 1007   | grpc client is not connected to CENTRAL                                                                                                              | Check `CENTRAL_URL` configuration. See [Administer AWS Gateway network traffic](/docs/connect_manage_environ/connected_agent_common_reference/network_traffic/) and make sure your outbound rules enable the connection to this url.                                                             |
| 1008   | harvester client is not connected to CENTRAL                                                                                                         | Check `CENTRAL_URL` configuration. See [Administer AWS Gateway network traffic](/docs/connect_manage_environ/connected_agent_common_reference/network_traffic/) and make sure your outbound rules enable the connection to this url.                                                             |
| 1100   | general configuration error in CENTRAL                                                                                                               | `CENTRAL_AGENTNAME` is set but corresponding resources do not exist. Either [create agent resources](/docs/connect_manage_environ//environment_agent_resources) or remove the `CENTRAL_AGENTNAME` variable.                                                                                      |
| 1101   | error attempting to query for ENVIRONMENT                                                                                                            | Check that the Environment Name (`CENTRAL_ENVIRONMENT`) in configuration matches the name on Enterprise Marketplace.                                                                                                                                                                             |
| 1102   | could not find specified team in Enterprise Marketplace, check CENTRAL_TEAM                                                                          | Check that the Team Name (`CENTRAL_TEAM`) in configuration matches the name on Enterprise Marketplace.                                                                                                                                                                                           |
| 1110   | connection to Enterprise Marketplace failed                                                                                                          | Check `CENTRAL_URL` configuration. See [Administer AWS Gateway network traffic](/docs/connect_manage_environ/connected_agent_common_reference/network_traffic/) and make sure your outbound rule enable the connection to this url.                                                              |
| 1120   | request to Enterprise Marketplace failed                                                                                                             | A request is not processed correctly. Set `LOG_LEVEL=trace` in agent configuration to retrieve the failing request and help diagnose the issue.                                                                                                                                                  |
| 1130   | request to get authentication token failed                                                                                                           | Check the `CENTRAL_AUTH_*` configuration (ClientId, Private and Public keys). Verify that you can connect to platform.axway.com. See [Administer API Manager network traffic](/docs/connect_manage_environ/connected_agent_common_reference/network_traffic/).                                   |
| 1131   | token retrieved but was invalid on request to Enterprise Marketplace                                                                                 | The token to communicate with Platform is not valid. The agent will try to get a new token. Check the `CENTRAL_AUTH_*` configuration (ClientId, Private and Public keys). See [Reference - Agent configuration](/docs/connect_manage_environ/connect_aws_gateway/deploy-your-agents-1/).         |
| 1139   | couldn't find a subscriber email address based on the ID in the subscription event                                                                   | The user requesting this subscription may not have an email address set.                                                                                                                                                                                                                         |
| 1145   | unable to create secret  for the subscription definition                                                                                             | See [Administer AWS Gateway network traffic](/docs/connect_manage_environ/connected_agent_common_reference/network_traffic/).                                                                                                                                                                    |
| 1146   | unexpected response code when creating an access request subscription schema                                                                         | See [Administer API Manager network traffic](/docs/connect_manage_environ/connected_agent_common_reference/network_traffic/). Set `LOG_LEVEL=trace` in agent configuration to retrieve the failing request and help diagnose the issue.                                                          |
| 1147   | error parsing filter in configuration. Syntax error                                                                                                  | See [Discover APIs](/docs/connect_manage_environ/connect_aws_gateway/filtering-apis-to-be-discovered-1/).                                                                                                                                                                                        |
| 1148   | error parsing filter in configuration. Unrecognized expression                                                                                       | See [Discover APIs](/docs/connect_manage_environ/connect_aws_gateway/filtering-apis-to-be-discovered-1/).                                                                                                                                                                                        |
| 1149   | error parsing filter in configuration                                                                                                                | See [Discover APIs](/docs/connect_manage_environ/connect_aws_gateway/filtering-apis-to-be-discovered-1/).                                                                                                                                                                                        |
| 1150   | error parsing filter in configuration. Invalid call argument                                                                                         | See [Discover APIs](/docs/connect_manage_environ/connect_aws_gateway/filtering-apis-to-be-discovered-1/).                                                                                                                                                                                        |
| 1151   | error parsing filter in configuration. Invalid selector type                                                                                         | See [Discover APIs](/docs/connect_manage_environ/connect_aws_gateway/filtering-apis-to-be-discovered-1/).                                                                                                                                                                                        |
| 1152   | error parsing filter in configuration. Invalid selector expression                                                                                   | See [Discover APIs](/docs/connect_manage_environ/connect_aws_gateway/filtering-apis-to-be-discovered-1/).                                                                                                                                                                                        |
| 1153   | error parsing filter in configuration. Invalid operator                                                                                              | See [Discover APIs](/docs/connect_manage_environ/connect_aws_gateway/filtering-apis-to-be-discovered-1/).                                                                                                                                                                                        |
| 1154   | error parsing filter in configuration. Unrecognized condition                                                                                        | See [Discover APIs](/docs/connect_manage_environ/connect_aws_gateway/filtering-apis-to-be-discovered-1/).                                                                                                                                                                                        |
| 1155   | error getting subscription definition properties in Enterprise Marketplace                                                                           | See [Administer AWS Gateway network traffic](/docs/connect_manage_environ/connected_agent_common_reference/network_traffic/) and [Reference - Agent configuration](/docs/connect_manage_environ/connect_aws_gateway/deploy-your-agents-1/).                                                      |
| 1156   | error updating subscription definition properties in Enterprise Marketplace                                                                          | See [Administer AWS Gateway network traffic](/docs/connect_manage_environ/connected_agent_common_reference/network_traffic/) and [Reference - Agent configuration](/docs/connect_manage_environ/connect_aws_gateway/deploy-your-agents-1/).                                                      |
| 1158   | Subscription Manager is not running likely because the agent can't communicate with Enterprise Marketplace                                           | See [Administer AWS Gateway network traffic](/docs/connect_manage_environ/connected_agent_common_reference/network_traffic/) and [Reference - Agent configuration](/docs/connect_manage_environ/connect_aws_gateway/deploy-your-agents-1/).                                                      |
| 1160   | error getting endpoints for the API specification                                                                                                    | Verify that the OpenAPI Specification for the discovered API has available endpoints and operations on each endpoint.                                                                                                                                                                            |
| 1161   | error deleting API service for catalog item in Enterprise Marketplace                                                                                | Verify that the catalog item exists in Enterprise Marketplace.                                                                                                                                                                                                                                   |
| 1162   | error deleting catalog item in Enterprise Marketplace                                                                                                | Verify that the catalog item exists in Enterprise Marketplace.                                                                                                                                                                                                                                   |
| 1163   | error retrieving API service resource instances                                                                                                      | Verify that the service exists in Enterprise Marketplace.                                                                                                                                                                                                                                        |
| 1302   | error creating data for sending subscription notification                                                                                            | Check AWS Console for configuration of API and its Usage Plan(s/index.html).                                                                                                                                                                                                                     |
| 1303   | email template not updated because an invalid authType was supplied                                                                                  | Check AWS Console for configuration of API and its Usage Plan(s/index.html), specifically enabled API Keys on the Usage Plan.                                                                                                                                                                    |
| 1401   | error parsing configuration values, check the config referenced in error                                                                             | See [Reference - Agent configuration](/docs/connect_manage_environ/connect_aws_gateway/deploy-your-agents-1/).                                                                                                                                                                                   |
| 1402   | error in overriding configuration using file with environment variables                                                                              | See [Reference - Agent configuration](/docs/connect_manage_environ/connect_aws_gateway/deploy-your-agents-1/). Make sure the env_vars file exists and is properly formatted.                                                                                                                     |
| 1403   | invalid value for statusHealthCheckPeriod. Value must be between 1 and 5 minutes                                                                     | See [Reference - Agent configuration](/docs/connect_manage_environ/connect_aws_gateway/deploy-your-agents-1/) variable `STATUS_HEALTHCHECKPERIOD`.                                                                                                                                               |
| 1404   | invalid value for statusHealthCheckInterval. Value must be between 30 seconds and 5 minutes                                                          | See [Reference - Agent configuration](/docs/connect_manage_environ/connect_aws_gateway/deploy-your-agents-1/) variable `STATUS_HEALTHCHECKINTERVAL`.                                                                                                                                             |
| 1405   | a key file could not be read                                                                                                                         | On Linux, give the User ID in the container read access to the file `setfacl -m u:2500:r private_key.pem`.                                                                                                                                                                                       |
| 1406   | using a DOSA_* service account with Marketplace Provisioning is unsupported, Please use a Platform service account instead of legacy service account | See [Reference - Agent configuration](/docs/connect_manage_environ/connect_api_manager/agent-variables/).                                                                                                                                                                                        |
| 1410   | invalid configuration settings for the logging setup                                                                                                 | See [Reference - Agent configuration](/docs/connect_manage_environ/connect_aws_gateway/deploy-your-agents-1/) for logging configuration options.                                                                                                                                                 |
| 1503   | http transport is not connected                                                                                                                      | See the `TRACEABILITY_HOST` setting. See [Reference - Agent configuration](/docs/connect_manage_environ/connect_aws_gateway/deploy-your-agents-1/).                                                                                                                                              |
| 1504   | failed to encode the json content                                                                                                                    | Internal system error. Contact your system administrator.                                                                                                                                                                                                                                        |
| 1505   | invalid traceability config                                                                                                                          | See [Reference - Agent configuration](/docs/connect_manage_environ/connect_aws_gateway/deploy-your-agents-1/) for the Traceability  Configuration.                                                                                                                                               |
| 1506   | error while compiling regular expression                                                                                                             | See [Trace redaction](/docs/connect_manage_environ/connected_agent_common_reference/trace_redaction/).                                                                                                                                                                                           |
| 1510   | global redactions have not been initialized                                                                                                          | See [Trace redaction](/docs/connect_manage_environ/connected_agent_common_reference/trace_redaction/).                                                                                                                                                                                           |
| 1511   | error while compiling regular expression                                                                                                             | See [Trace redaction](/docs/connect_manage_environ/connected_agent_common_reference/trace_redaction/).                                                                                                                                                                                           |
| 1520   | global sampling has not been initialized                                                                                                             | See [Trace sampling](/docs/connect_manage_environ/connected_agent_common_reference/trace_sampling/).                                                                                                                                                                                             |
| 1521   | invalid sampling configuration                                                                                                                       | See [Trace sampling](/docs/connect_manage_environ/connected_agent_common_reference/trace_sampling/).                                                                                                                                                                                             |
| 1550   | error hit while applying redaction                                                                                                                   | See [Trace redaction](/docs/connect_manage_environ/connected_agent_common_reference/trace_redaction/).                                                                                                                                                                                           |
| 1600   | error registering the job                                                                                                                            | The agent attempted to register a job, but could not do so successfully.                                                                                                                                                                                                                         |
| 1601   | error executing a job                                                                                                                                | A job defined in the agent failed, see the logs for more information.                                                                                                                                                                                                                            |
| 1602   | error executing a retry job                                                                                                                          | A job defined in the agent failed, see the logs for more information.                                                                                                                                                                                                                            |
|        | **Specific error for AWS Discovery agents**                                                                                                          |                                                                                                                                                                                                                                                                                                  |
| 2001   | aws region must be set in the configuration                                                                                                          | Check that `AWS_REGION` is set in the configuration. See [Reference - Agent configuration](/docs/connect_manage_environ/connect_aws_gateway/deploy-your-agents-1/).                                                                                                                              |
| 2100   | failed to process subscription request. Cannot find API related to ID                                                                                | Could not find the Rest API on AWS related to this Catalog Item. It may have been removed from AWS.                                                                                                                                                                                              |
| 2101   | failed to process a request for a rest api and stage                                                                                                 | Check AWS Setup. See [Administer AWS Gateway cloud](/docs/connect_manage_environ/connect_aws_gateway/cloud-administration-operation/).                                                                                                                                                           |
| 2102   | can't get email address for a Service Account subscriber                                                                                             | A service account was used to create this subscription that does not have an email address associated with it.                                                                                                                                                                                   |
| 2110   | unable to register the subscription schema with API Key auth                                                                                         | Check the usage plan selected and ensure it has an enabled API Key.                                                                                                                                                                                                                              |
| 2111   | unable to update a subscription schema                                                                                                               | Check that the environment is configured and exists in Enterprise Marketplace. See [Reference - Agent configuration](/docs/connect_manage_environ/connect_aws_gateway/deploy-your-agents-1/).                                                                                                    |
| 2112   | error updating subscription in Enterprise Marketplace                                                                                                | Check that the environment is configured and exists in Enterprise Marketplace. See [Reference - Agent configuration](/docs/connect_manage_environ/connect_aws_gateway/deploy-your-agents-1/).                                                                                                    |
| 2200   | error getting a list of AWS resources from AWS                                                                                                       | Check AWS Setup. See [Administer AWS Gateway cloud](/docs/connect_manage_environ/connect_aws_gateway/cloud-administration-operation/).                                                                                                                                                           |
| 2201   | error getting a specific AWS resource                                                                                                                | Check AWS Setup. See [Administer AWS Gateway cloud](/docs/connect_manage_environ/connect_aws_gateway/cloud-administration-operation/).                                                                                                                                                           |
| 2202   | error updating an AWS resource                                                                                                                       | Check AWS Setup. See [Administer AWS Gateway cloud](/docs/connect_manage_environ/connect_aws_gateway/cloud-administration-operation/).                                                                                                                                                           |
| 2203   | error tagging an AWS resource                                                                                                                        | Check AWS Setup. See [Administer AWS Gateway cloud](/docs/connect_manage_environ/connect_aws_gateway/cloud-administration-operation/).                                                                                                                                                           |
| 2204   | error creating an association between AWS resources                                                                                                  | Check AWS Setup. See [Administer AWS Gateway cloud](/docs/connect_manage_environ/connect_aws_gateway/cloud-administration-operation/).                                                                                                                                                           |
| 2205   | error sending the list of usage plans                                                                                                                | Could not update the agent cache with the new list of Usage Plans.                                                                                                                                                                                                                               |
| 2206   | error creating a specific AWS resource                                                                                                               | Check AWS Setup. See [Administer AWS Gateway cloud](/docs/connect_manage_environ/connect_aws_gateway/cloud-administration-operation/).                                                                                                                                                           |
| 2207   | error deleting a specific AWS resource                                                                                                               | Check AWS Setup. See [Administer AWS Gateway cloud](/docs/connect_manage_environ/connect_aws_gateway/cloud-administration-operation/).                                                                                                                                                           |
| 2210   | error loading AWS configuration                                                                                                                      | Check AWS Setup. See [Administer AWS Gateway cloud](/docs/connect_manage_environ/connect_aws_gateway/cloud-administration-operation/).                                                                                                                                                           |
|        | **Specific error for AWS Traceability agents**                                                                                                       |                                                                                                                                                                                                                                                                                                  |
| 2500   | could not set the proxy url environment variable                                                                                                     | Check the LOGSTASH_PROXYURL setting. See [Reference - Agent configuration](/docs/connect_manage_environ/connect_aws_gateway/deploy-your-agents-1/).                                                                                                                                              |
| 2600   | error sending request to AWS CloudWatch                                                                                                              | Check AWS Setup. See [Administer AWS Gateway cloud](/docs/connect_manage_environ/connect_aws_gateway/cloud-administration-operation/).                                                                                                                                                           |
